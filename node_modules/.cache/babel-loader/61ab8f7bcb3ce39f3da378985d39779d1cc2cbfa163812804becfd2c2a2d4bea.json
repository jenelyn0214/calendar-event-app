{"ast":null,"code":"var _jsxFileName = \"/Users/gylou/Documents/projects/calendar-event-app/src/App.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport LoginPage from './screen/LoginPage';\nimport CalendarPage from './screen/CalendarPage';\nimport { jwtDecode } from 'jwt-decode';\nimport { logoutUser } from './actions/authActions';\nimport { loginSuccess } from './reducers/authReducer';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const dispatch = useDispatch();\n  const isLoggedIn = useSelector(state => state.auth.isLoggedIn);\n  const token = useSelector(state => state.auth.token);\n  console.log('dadadatoken', token);\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      const decoded = jwtDecode(token);\n      const now = Date.now() / 1000;\n      console.log('decoded.exp', decoded.exp, now > decoded.exp);\n      if (now > decoded.exp) {\n        dispatch(logoutUser());\n      } else {\n        dispatch(loginSuccess({\n          token,\n          user: decoded\n        }));\n      }\n    }\n  }, [dispatch]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: isLoggedIn ? /*#__PURE__*/_jsxDEV(CalendarPage, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 21\n    }, this) : /*#__PURE__*/_jsxDEV(LoginPage, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 40\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 33,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"mYzYqSzsFReluqd7c93wA881kbQ=\", false, function () {\n  return [useDispatch, useSelector, useSelector];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useDispatch","useSelector","LoginPage","CalendarPage","jwtDecode","logoutUser","loginSuccess","jsxDEV","_jsxDEV","App","_s","dispatch","isLoggedIn","state","auth","token","console","log","localStorage","getItem","decoded","now","Date","exp","user","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/gylou/Documents/projects/calendar-event-app/src/App.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport LoginPage from './screen/LoginPage';\nimport CalendarPage from './screen/CalendarPage';\nimport { RootState, AppDispatch } from './store';\nimport {jwtDecode} from 'jwt-decode';\nimport { logoutUser } from './actions/authActions';\nimport { loginSuccess } from './reducers/authReducer';\n\nfunction App() {\n  const dispatch = useDispatch<AppDispatch>();\n  const isLoggedIn = useSelector((state: RootState) => state.auth.isLoggedIn);\n  const token = useSelector((state: RootState) => state.auth.token);\n  console.log('dadadatoken',token)\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      const decoded: any = jwtDecode(token);\n      const now = Date.now() / 1000;\n\n      console.log('decoded.exp',decoded.exp,now > decoded.exp)\n\n      if (now > decoded.exp) {\n        dispatch(logoutUser());\n      }else{\n        dispatch(loginSuccess({ token, user:decoded }));\n      }\n    }\n  }, [dispatch]);\n\n  return (\n    <div className=\"App\">\n      {isLoggedIn ? <CalendarPage /> : <LoginPage />}\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,SAASC,WAAW,EAAEC,WAAW,QAAQ,aAAa;AACtD,OAAOC,SAAS,MAAM,oBAAoB;AAC1C,OAAOC,YAAY,MAAM,uBAAuB;AAEhD,SAAQC,SAAS,QAAO,YAAY;AACpC,SAASC,UAAU,QAAQ,uBAAuB;AAClD,SAASC,YAAY,QAAQ,wBAAwB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEtD,SAASC,GAAGA,CAAA,EAAG;EAAAC,EAAA;EACb,MAAMC,QAAQ,GAAGX,WAAW,CAAc,CAAC;EAC3C,MAAMY,UAAU,GAAGX,WAAW,CAAEY,KAAgB,IAAKA,KAAK,CAACC,IAAI,CAACF,UAAU,CAAC;EAC3E,MAAMG,KAAK,GAAGd,WAAW,CAAEY,KAAgB,IAAKA,KAAK,CAACC,IAAI,CAACC,KAAK,CAAC;EACjEC,OAAO,CAACC,GAAG,CAAC,aAAa,EAACF,KAAK,CAAC;EAEhChB,SAAS,CAAC,MAAM;IACd,MAAMgB,KAAK,GAAGG,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,IAAIJ,KAAK,EAAE;MACT,MAAMK,OAAY,GAAGhB,SAAS,CAACW,KAAK,CAAC;MACrC,MAAMM,GAAG,GAAGC,IAAI,CAACD,GAAG,CAAC,CAAC,GAAG,IAAI;MAE7BL,OAAO,CAACC,GAAG,CAAC,aAAa,EAACG,OAAO,CAACG,GAAG,EAACF,GAAG,GAAGD,OAAO,CAACG,GAAG,CAAC;MAExD,IAAIF,GAAG,GAAGD,OAAO,CAACG,GAAG,EAAE;QACrBZ,QAAQ,CAACN,UAAU,CAAC,CAAC,CAAC;MACxB,CAAC,MAAI;QACHM,QAAQ,CAACL,YAAY,CAAC;UAAES,KAAK;UAAES,IAAI,EAACJ;QAAQ,CAAC,CAAC,CAAC;MACjD;IACF;EACF,CAAC,EAAE,CAACT,QAAQ,CAAC,CAAC;EAEd,oBACEH,OAAA;IAAKiB,SAAS,EAAC,KAAK;IAAAC,QAAA,EACjBd,UAAU,gBAAGJ,OAAA,CAACL,YAAY;MAAAwB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,gBAAGtB,OAAA,CAACN,SAAS;MAAAyB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAC3C,CAAC;AAEV;AAACpB,EAAA,CA3BQD,GAAG;EAAA,QACOT,WAAW,EACTC,WAAW,EAChBA,WAAW;AAAA;AAAA8B,EAAA,GAHlBtB,GAAG;AA6BZ,eAAeA,GAAG;AAAC,IAAAsB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}